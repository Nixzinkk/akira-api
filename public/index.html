<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AKIRA-API Dashboard</title>
<style>
  :root {
    --bg:#0f111a;
    --card:#1f2235;
    --radius:14px;
    --shadow:0 25px 60px -10px rgba(0,0,0,.6);
    --gradient:linear-gradient(135deg,#6f5ce8,#e86fb3);
    --text:#e4e9f8;
    --muted:#8a93b2;
    --border:rgba(255,255,255,.08);
    font-family: "Segoe UI", system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  }
  *{box-sizing:border-box;}
  body {
    margin:0;
    background: radial-gradient(circle at 30% 40%, #1a1f3f 0%, #0f111a 80%);
    color: var(--text);
    min-height:100vh;
  }
  .container {
    max-width: 600px;
    margin: 2rem auto;
    padding:1.5rem 1rem 4rem;
  }
  .key-panel {
    display:flex;
    gap:1rem;
    flex-wrap:wrap;
    justify-content:center;
  }
  .card {
    background: var(--card);
    border-radius:16px;
    padding:1.25rem 1.5rem;
    box-shadow: var(--shadow);
    flex:1 1 280px;
    display:flex;
    flex-direction:column;
    gap:1rem;
    position:relative;
  }
  .btn {
    cursor:pointer;
    border:none;
    padding:12px 18px;
    border-radius:10px;
    font-weight:600;
    display:inline-flex;
    align-items:center;
    gap:6px;
    transition:filter .2s;
    background: var(--gradient);
    color:#fff;
  }
  .btn-secondary {
    background:rgba(255,255,255,.08);
    color:#fff;
  }
  .meter {
    background: var(--border);
    border-radius:8px;
    overflow:hidden;
    flex:1;
    height:12px;
    position:relative;
  }
  .meter-inner {
    height:100%;
    background: #00d084;
    transition:width .25s;
  }
  .key-display {
    background: #0f111a;
    border:1px solid var(--border);
    padding:10px 12px;
    border-radius:8px;
    font-family: monospace;
    width:100%;
    color:#fff;
    user-select: all;
  }
  .normal-badge {
    background:#6f5ce8;
    color:#fff;
    padding:5px 12px;
    border-radius:999px;
    font-size:0.6rem;
    font-weight:600;
    display:inline-block;
  }
  .free-badge {
    background:#ffb86c;
    color:#1f1f30;
    padding:5px 12px;
    border-radius:999px;
    font-size:0.6rem;
    font-weight:600;
    display:inline-block;
  }
  .note {
    font-size:0.75rem;
    color: var(--muted);
  }
  .status-line {
    display:flex;
    justify-content:space-between;
    flex-wrap:wrap;
    gap:6px;
  }
</style>
</head>
<body>
<div class="container">

  <div class="key-panel">
    <div class="card" id="normal-key-card">
      <div style="display:flex; justify-content:space-between; align-items:start; flex-wrap:wrap; gap:10px;">
        <div>
          <div style="display:flex; align-items:center; gap:8px;">
            <div class="normal-badge">Key Normal</div>
            <div style="font-weight:600; margin-left:4px;">Limite: 500 requisições</div>
          </div>
          <div style="font-size:0.8rem; margin-top:4px;">Só gera nova quando a atual for esgotada.</div>
        </div>
        <div>
          <button class="btn" id="generate-normal">Gerar Key</button>
        </div>
      </div>
      <div class="status-line">
        <div style="flex:1; min-width:160px; margin-top:8px;">
          <div style="margin-bottom:6px;">Chave atual:</div>
          <div class="key-display" id="normal-key">—</div>
        </div>
        <div style="min-width:220px; margin-top:8px;">
          <div style="margin-bottom:4px;">Uso: <span id="normal-used">0</span> / 500</div>
          <div class="meter">
            <div class="meter-inner" id="normal-meter" style="width:0%;"></div>
          </div>
          <div class="note" id="normal-status-text">Nenhuma key ativa</div>
        </div>
      </div>
      <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn-secondary" id="copy-normal">Copiar Key</button>
        <button class="btn-secondary" id="reset-normal">Zerar (dev)</button>
      </div>
    </div>

    <div class="card" id="free-key-card">
      <div style="display:flex; justify-content:space-between; align-items:start; flex-wrap:wrap; gap:10px;">
        <div>
          <div style="display:flex; align-items:center; gap:8px;">
            <div class="free-badge">KEYFREE</div>
            <div style="font-weight:600; margin-left:4px;">Infinita</div>
          </div>
          <div style="font-size:0.8rem; margin-top:4px;">Sem limite de requisições. Mais lenta no backend.</div>
        </div>
      </div>
      <div class="status-line">
        <div style="flex:1; min-width:160px; margin-top:8px;">
          <div style="margin-bottom:6px;">Chave fixa:</div>
          <div class="key-display" id="free-key">KEYFREE</div>
        </div>
        <div style="min-width:220px; margin-top:8px;">
          <div class="note">Sem restrição de uso do front. Priorização e latência são controladas no backend.</div>
        </div>
      </div>
      <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn-secondary" id="copy-free">Copiar Key</button>
      </div>
    </div>
  </div>

</div>

<script>
  const NORMAL_LIMIT = 500;
  let normalKeyData = { key: null, used: 0, active: false };
  const BASE = "https://akira-api-8je8.onrender.com";

  function randomKey(length = 28) {
    const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    let s = "";
    for (let i = 0; i < length; i++) s += chars.charAt(Math.floor(Math.random() * chars.length));
    return s;
  }

  function updateNormalUI() {
    document.getElementById("normal-key").textContent = normalKeyData.active ? normalKeyData.key : "—";
    document.getElementById("normal-used").textContent = normalKeyData.used;
    const percent = normalKeyData.active ? Math.min(100, (normalKeyData.used / NORMAL_LIMIT) * 100) : 0;
    document.getElementById("normal-meter").style.width = percent + "%";
    const statusText = normalKeyData.active
      ? (normalKeyData.used >= NORMAL_LIMIT ? "Esgotada. Gere nova." : `Restam ${NORMAL_LIMIT - normalKeyData.used} requisições.`)
      : "Nenhuma key ativa";
    document.getElementById("normal-status-text").textContent = statusText;
    document.getElementById("generate-normal").disabled = normalKeyData.active && normalKeyData.used < NORMAL_LIMIT;
  }

  function getActiveKeyForRequest() {
    if (normalKeyData.active && normalKeyData.used < NORMAL_LIMIT) return { key: normalKeyData.key, type: "normal" };
    return { key: "KEYFREE", type: "free" };
  }

  function incrementNormalUsage() {
    if (normalKeyData.active && normalKeyData.used < NORMAL_LIMIT) {
      normalKeyData.used += 1;
      updateNormalUI();
    }
  }

  document.getElementById("generate-normal").addEventListener("click", () => {
    if (normalKeyData.active && normalKeyData.used < NORMAL_LIMIT) {
      alert("Você ainda tem uma Key normal ativa. Espere ela esgotar para gerar outra.");
      return;
    }
    normalKeyData.key = randomKey();
    normalKeyData.used = 0;
    normalKeyData.active = true;
    updateNormalUI();
    alert("Nova Key normal gerada:\n" + normalKeyData.key);
  });

  document.getElementById("copy-normal").addEventListener("click", () => {
    if (!normalKeyData.active) {
      alert("Nenhuma Key normal ativa para copiar.");
      return;
    }
    navigator.clipboard.writeText(normalKeyData.key).then(() => alert("Key normal copiada!"));
  });

  document.getElementById("reset-normal").addEventListener("click", () => {
    normalKeyData = { key: null, used: 0, active: false };
    updateNormalUI();
  });

  document.getElementById("copy-free").addEventListener("click", () => {
    navigator.clipboard.writeText("KEYFREE").then(() => alert("Key Free copiada!"));
  });


  // FUNÇÕES PARA CHAMAR SUAS ROTAS REAIS DA API (USO INTERNO / INTEGRAÇÃO BOT)

  async function fetchAPI(path, key) {
    try {
      const res = await fetch(`${BASE}${path}`, {
        headers: { Authorization: `Bearer ${key}` },
      });
      if (!res.ok) throw new Error(`Erro HTTP ${res.status}`);
      return await res.json();
    } catch (e) {
      return { error: e.message };
    }
  }

  // Exemplo para chamar rota /ytsearchvideo?query=...
  // Retorna json com lista de vídeos, cada um tem url e title

  async function ytSearchVideo(query) {
    const { key } = getActiveKeyForRequest();
    const res = await fetchAPI(`/ytsearchvideo?query=${encodeURIComponent(query)}`, key);
    if (!res.error) incrementNormalUsage();
    return res;
  }

  // Exemplo para chamar rota /ytmp3?url=...
  // Retorna json com link direto para download do áudio

  async function ytDownloadMp3(url) {
    const { key } = getActiveKeyForRequest();
    const res = await fetchAPI(`/ytmp3?url=${encodeURIComponent(url)}`, key);
    if (!res.error) incrementNormalUsage();
    return res;
  }

  // Exemplo para chamar rota /ytmp4?url=...
  // Retorna json com link direto para download do vídeo

  async function ytDownloadMp4(url) {
    const { key } = getActiveKeyForRequest();
    const res = await fetchAPI(`/ytmp4?url=${encodeURIComponent(url)}`, key);
    if (!res.error) incrementNormalUsage();
    return res;
  }

  // Exemplo para chamar rota /pinterest?query=...
  // Retorna json com array de URLs de imagens

  async function pinterestSearch(query) {
    const { key } = getActiveKeyForRequest();
    const res = await fetchAPI(`/pinterest?query=${encodeURIComponent(query)}`, key);
    if (!res.error) incrementNormalUsage();
    return res;
  }

  // Exemplo para chamar rota /mediafire?url=...
  // Retorna json com link direto para download do arquivo

  async function mediafireDownload(url) {
    const { key } = getActiveKeyForRequest();
    const res = await fetchAPI(`/mediafire?url=${encodeURIComponent(url)}`, key);
    if (!res.error) incrementNormalUsage();
    return res;
  }

  // Exemplo para chamar rota /meganz?url=...
  // Retorna json com link direto para download do arquivo

  async function meganzDownload(url) {
    const { key } = getActiveKeyForRequest();
    const res = await fetchAPI(`/meganz?url=${encodeURIComponent(url)}`, key);
    if (!res.error) incrementNormalUsage();
    return res;
  }

  updateNormalUI();
</script>
</body>
</html>